# Https概述
首先什么是Https呢？ 简单来说 Https = Http + SSL/TLS. 或者说是一种通过计算机网络进行安全通信的传输协议。HTTPS经由HTTP进行通信，但利用TLS来加密数据包。HTTPS开发的主要目的，是提供对网站服务器的身份认证，保护交换数据的隐私与完整性。

什么是TLS呢？ TLS是传输层加密协议，前身是SSL协议。由网景公司于1995年发布。后改名为TLS。常用的 TLS 协议版本有：TLS1.2, TLS1.1, TLS1.0 和 SSL3.0。


由于HTTP协议采用明文传输，我们可以通过抓包很轻松的获取到HTTP所传输的数据。因此，采用HTTP协议是不安全的。这才催生了HTTPS的诞生。

HTTPS相对HTTP提供了更安全的数据传输保障，主要体现在三个方面：

1）内容加密：客户端到服务器的内容都是以加密形式传输，中间者无法直接查看明文内容；
2）身份认证：通过校验保证客户端访问的是自己的服务器；
3）数据完整性：防止内容被第三方冒充或者篡改。

# Https实现原理
在学习HTTPS原理之前我们先了解一下两种加密方式： 对称加密和非对称加密。

对称加密：
即加密和解密使用同一个密钥，虽然对称加密破解难度很大，但由于对称加密需要在网络上传输密钥和密文，一旦被黑客截取很容就能被破解，因此对称加密并不是一个较好的选择。 （详见文章：《即时通讯安全篇（三）：常用加解密算法与通讯安全讲解》）

非对称加密：
即加密和解密使用不同的密钥，分别称为公钥和私钥。我们可以用公钥对数据进行加密，但必须要用私钥才能解密。在网络上只需要传送公钥，私钥保存在服务端用于解密公钥加密后的密文。但是非对称加密消耗的CPU资源非常大，效率很低，严重影响HTTPS的性能和速度。因此非对称加密也不是HTTPS的理想选择。（详见文章：《即时通讯安全篇（六）：非对称加密技术的原理与应用实践》）

那么HTTPS采用了怎样的加密方式呢？其实为了提高安全性和效率HTTPS结合了对称和非对称两种加密方式。即客户端使用对称加密生成密钥（key）对传输数据进行加密，然后使用非对称加密的公钥再对key进行加密。因此网络上传输的数据是被key加密的密文和用公钥加密后的密文key，因此即使被黑客截取，由于没有私钥，无法获取到明文key，便无法获取到明文数据。所以HTTPS的加密方式是安全的。

接下来我们以TLS1.2为例来认识HTTPS的握手过程：

1）客户端发送 client_hello，包含一个随机数 random1；
2）服务端回复 server_hello，包含一个随机数 random2，携带了证书公钥 P；
3）客户端接收到 random2 之后就能够生成 premaster_secrect （对称加密的密钥）以及 master_secrect（用premaster_secret加密后的数据）；
4）客户端使用证书公钥 P 将 premaster_secrect 加密后发送给服务器 (用公钥P对premaster_secret加密)；
5）服务端使用私钥解密得到 premaster_secrect。又由于服务端之前就收到了随机数 1，所以服务端根据相同的生成算法，在相同的输入参数下，求出了相同的 master secrect。

HTTPS的握手过程如下图：

# 数字证书

# https单向认证

# https双向认证