### Service与thread的区别
#### 简介
在日常开发中，常常会用到thread，也会在某些场景下用到service。而两者在很多地方有些许相似点，为了搞清楚两者具体的异同，特别整理以下内容。
#### 涉及知识
1. thread线程的基础
2. service的基础

#### thread
线程是程序执行的最小单元，可以执行异步操作。

#### Service
android官方对service的定义：一个服务（Service）是一个应用的组件，其可以在后台执行长时间的操作，而且不提供UI。其他应用组件可以开启一个服务，该服务将会在后台一直运行，纵使用户切换到了其他应用。另外，一个组件可以捆绑到服务上，来与其交互，甚至执行IPC。例如，一个服务可以执行网络链接、播放音乐、执行I/O或者和一个内容提供者（Content Provider）交互，都是在后台运行。

那么，我们对service存在的迷惑之处应该来源于 **其可以在后台执行长时间的操作**. 这不就是可以在后台执行些耗时操作嘛。注意官方在下面又说：**一个服务（service）运行在主线程中，服务并不创建自己的线程，也不在隔离进程中运行（除非你指定）。这意味着，如果你的服务要执行CPU费时操作或阻塞操作，你需要在服务中创建新的线程来执行该操作。使用其他线程，可以避免ANR错误，保证应用的主线程可以与用户交互。**

或许还有疑惑，既然service不能执行耗时后台任务，为什么还要存在service呢？

因此service虽然是在后台执行，但是还是在主线程中。这里的“后台执行”真正含义在于：与ui无关的操作，处于屏幕事件分发与响应之背后。而在处理耗时的会阻塞的cpu或者io操作的时候，还是要在子线程中处理的哦。

其实大家不要把后台和子线程联系在一起就行了，这是两个完全不同的概念。Android的后台就是指，它的运行是完全不依赖UI的。即使Activity被销毁，或者程序被关闭，只要进程还在，Service就可以继续运行。比如说一些应用程序，始终需要与服务器之间始终保持着心跳连接，就可以使用Service来实现。你可能又会问，前面不是刚刚验证过Service是运行在主线程里的么？在这里一直执行着心跳连接，难道就不会阻塞主线程的运行吗？当然会，但是我们可以在Service中再创建一个子线程，然后在这里去处理耗时逻辑就没问题了。

额，既然在Service里也要创建一个子线程，那为什么不直接在Activity里创建呢？其实这跟android的系统机制有关，我们先拿Thread来说。Thread 的运行是独立于 Activity 的，也就是说当一个 Activity 被 finish 之后，如果你没有主动停止 Thread 或者 Thread 里的 run 方法没有执行完毕的话，Thread 也会一直执行。因此这里会出现一个问题：当 Activity 被 finish 之后，你不再持有该 Thread 的引用。另一方面，你没有办法在不同的 Activity 中对同一 Thread 进行控制。因为Activity很难对Thread进行控制，当Activity被销毁之后，就没有任何其它的办法可以再重新获取到之前创建的子线程的实例。而且在一个Activity中创建的子线程，另一个Activity无法对其进行操作。但是Service就不同了，所有的Activity都可以与Service进行关联，然后可以很方便地操作其中的方法，即使Activity被销毁了，之后只要重新与Service建立关联，就又能够获取到原有的Service中Binder的实例。因此，使用Service来处理后台任务，Activity就可以放心地finish，完全不需要担心无法对后台任务进行控制的情况。

当在旋转手机屏幕的时候，当手机屏幕在“横”“竖”变换时，此时如果你的 Activity 如果会自动旋转的话，旋转其实是 Activity 的重新创建，因此旋转之前的使用 bindService 建立的连接便会断开（Context 不存在了），对应服务的生命周期与上述相同。

Service 是android的一种机制，当它运行的时候如果是Local Service，那么对应的 Service 是运行在主进程的 main 线程上的。如果是Remote Service，那么对应的 Service 则是运行在独立进程的 main 线程上，service和调用者之间的通讯都是同步的（不论是远程service还是本地service），它跟线程一点关系都没有！

你也可以在 Service 里注册 BroadcastReceiver，在其他地方通过发送 broadcast 来控制它，这些是 Thread 做不到的






#### 分类
Service几乎都是在后台运行的，一直以来它都是默默地做着辛苦的工作。但是Service的系统优先级还是比较低的，当系统出现内存不足情况时，就有可能会回收掉正在后台运行的Service。如果你希望Service可以一直保持运行状态，而不会由于系统内存不足的原因导致被回收，就可以考虑使用前台Service。前台Service和普通Service最大的区别就在于，它会一直有一个正在运行的图标在系统的状态栏显示，下拉状态栏后可以看到更加详细的信息，非常类似于通知的效果。
1. 前台service
2. 后台service



#### 总结一下
1. 如果你仅仅需要执行后台任务，并且是长时间的，执行周期可能会超过Activity的生命周期，且不需要和用户交互，此时你可以使用service； 
2. 如果你需要在主线程在执行任务，并且当需要和用户交互的时候，此时你可以选择新建一个thread而非service，例如，如果你仅仅需要在activity运行的时候播放音乐，你可以选择在Activity的onCreate方法中新建线程，在onStart方法中运行，在onStop方法中停止。或者，可以采用 AsyncTask或Handler线程。
3. 

