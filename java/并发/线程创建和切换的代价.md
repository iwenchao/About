#### 线程创建和切换的代价
- 创建线程和线程间切换对于性能和资源的消耗是不容忽视的，无限制地创建线程会消耗过多的内存资源并不可取，过多的线程间上下文切换也会降低多线程并发的性能。
- 但是线程创建和切换的代价到底是怎么产生的呢？这就不得不提到Java的运行时数据区了。
    - JVM 每遇到一个线程，就为其分配一个Program Counter Register（程序计数器）, VM Stack（虚拟机栈）和Native Method Stack （本地方法栈），当线程终止时，三者（虚拟机栈，本地方法栈和程序计数器）所占用的内存空间也会被释放掉。

1. 线程创建的内存代价
    - 分配内存的消耗
2. 线程切换的性能代价
    - JVM的并发是通过线程切换并分配时间片执行来实现的
    - 因此, 为了线程切换后能恢复到正确的执行位置, JVM需要先保存被挂起线程的上下文环境：将线程执行位置保存到程序计数器中，将调用方法的信息保存在栈中；同时将待执行线程的程序计数器和栈中的信息写入到处理器中，完成线程的上下文切换。维护线程隔离数据区中的内容在处理器中的导入导出，就是线程切换的性能代价。

    - 如何控制线程切换呢？
        1. 使用基于CAS的非拥塞算法
        2. 无锁并发编程，尽量使用线程封闭（ThreadLocal）或者不变量，而不是用锁
        3. 使用线程池+等待队列的方式，控制线程数目，
